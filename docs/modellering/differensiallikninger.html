

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Differensiallikninger og fartslover &#8212; Programmering i kjemi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/modellering/differensiallikninger';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Forelesninger" href="../forelesninger/forelesninger.html" />
    <link rel="prev" title="Differenslikninger" href="diskret_modellering.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/qe-logo-large.png" class="logo__image only-light" alt="Programmering i kjemi - Home"/>
    <script>document.write(`<img src="../../_static/qe-logo-large.png" class="logo__image only-dark" alt="Programmering i kjemi - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tema 1 - Grunnleggende programmering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../grunnleggende_programmering/kom_i_gang.html">En første kodesnutt</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../grunnleggende_programmering/tall_variabler.html">Variabler og datatyper</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../grunnleggende_programmering/quiz1.html">Quiz 1: Variabler og aritmetikk</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../grunnleggende_programmering/lister.html">Lister</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../grunnleggende_programmering/quiz2.html">Quiz 2: Lister</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../grunnleggende_programmering/if-tester.html">Vilkår (if-tester)</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../grunnleggende_programmering/quiz3.html">Quiz 3: Vilkår (if-tester)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../grunnleggende_programmering/lokker.html">Løkker</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../grunnleggende_programmering/quiz4.html">Quiz 4: Løkker</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../grunnleggende_programmering/funksjoner.html">Funksjoner</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../grunnleggende_programmering/quiz5.html">Quiz 5: Funksjoner</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../grunnleggende_programmering/datasamlinger.html">Datasamlinger</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../grunnleggende_programmering/quiz6.html">Quiz 6: Datasamlinger (arrayer og dictionarier)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tema 2 - Datahåndtering og visualisering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../datahandtering_visualisering/kjemiske_biblioteker.html">Kjemiske biblioteker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datahandtering_visualisering/molekylvisualisering.html">Molekylvisualisering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datahandtering_visualisering/plotting.html">Datahåndtering I: Visualisering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datahandtering_visualisering/lese_filer.html">Datahåndering II: Håndtere og visualisere data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datahandtering_visualisering/statistikk.html">Datahåndering III: Statistikk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datahandtering_visualisering/maskinlaring.html">Datahåndtering IV: Maskinlæring</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tema 3 - Numeriske metoder</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../nullpunkter_likninger/likninger.html">Likninger og nullpunkter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../derivasjon_integrasjon/derivasjon.html">Numerisk derivasjon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../derivasjon_integrasjon/integrasjon.html">Numerisk integrasjon</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tema 4 - Dynamiske systemer</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="diskret_modellering.html">Differenslikninger</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Differensiallikninger og fartslover</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Emneressurser (IN-KJM1900)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../forelesninger/forelesninger.html">Forelesninger</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../forelesninger/forelesning1.html">Forelesning 1: Programmering i kjemi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forelesninger/forelesning2.html">Forelesning 2: Plotting og datahåndtering</a></li>



<li class="toctree-l2"><a class="reference internal" href="../forelesninger/forelesning3.html">Forelesning 3: Statistisk analyse</a></li>

<li class="toctree-l2"><a class="reference internal" href="../forelesninger/forelesning4.html">Forelesning 4: Statistikk II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forelesninger/forelesning5.html">Forelesning 5: Numerisk derivasjon og likninger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forelesninger/forelesning6.html">Forelesning 6: Numerisk integrasjon</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../obliger/obliger.html">Obligatoriske oppgaver</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../obliger/oblig_datahandtering.html">Oblig 1: Håndtering av kjemiske data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../obliger/oblig_dynamiske_systemer.html">Oblig 2: Dynamiske systemer og integrasjon</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datafiler.html">Datafiler</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Biokjemi (KJM1140)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../biokjemi/molekylvisualisering.html">Molekylvisualisering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biokjemi/datavisualisering.html">Datavisualisering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biokjemi/regresjonsmodeller.html">Regresjonsmodeller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biokjemi/enzymkinetikklab2025.html">Analyse av enzymkinetikkdata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biokjemi/proteinfolding.html">Del 1: Monte-Carlo-simuleringer</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/modellering/differensiallikninger.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Differensiallikninger og fartslover</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivasjon">Motivasjon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#differensiallikninger-og-eulers-metode">Differensiallikninger og Eulers metode</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eulers-metode">Eulers metode</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementering">Implementering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newtons-2-lov">Newtons 2. lov</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#newtons-2-lov-i-kjemi">Newtons 2. lov i kjemi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fartslover-ratelover">Fartslover (ratelover)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backward-euler">Backward Euler</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runge-kutta-4">Runge-Kutta 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ode-losere">ODE-løsere</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#oppgaver">Oppgaver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videoer">Videoer</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="differensiallikninger-og-fartslover">
<h1>Differensiallikninger og fartslover<a class="headerlink" href="#differensiallikninger-og-fartslover" title="Permalink to this heading">#</a></h1>
<div class="admonition-laeringsutbytte admonition">
<p class="admonition-title">Læringsutbytte</p>
<p>Etter å ha arbeidet med dette temaet, skal du kunne:</p>
<ol class="arabic simple">
<li><p>Forklare hva som menes med differensiallikninger, og hvordan slike likninger kan brukes til å modellere ulike systemer.</p></li>
<li><p>Forklare og implementer Eulers metode (Forward Euler).</p></li>
<li><p>Løse ordinære differensiallikninger med egne Python-funksjoner og funksjoner fra Scipy-biblioteket.</p></li>
<li><p>Løse ratelover numerisk.</p></li>
</ol>
</div>
<section id="motivasjon">
<h2>Motivasjon<a class="headerlink" href="#motivasjon" title="Permalink to this heading">#</a></h2>
<p>Eksperimenter har stått i sentrum av kjemifaget i flere hundre år. Men med økende datakraft og billigere datamaskiner de siste 50 årene har simuleringer blitt et viktig tillegg til dette. Simuleringer kan belyse og supplere eksperimenter, i tillegg til at de kan illustrere viktige fenomener på egen hånd. Ved å studere molekyler og kjemiske reaksjoner med datamaskiner, kan vi få enda større innsikt i de mest fundamentale egenskapene og mekanismene til disse systemene.</p>
<p>Her skal vi se på metoder for modellering med differensiallikninger, spesielt anvendt på kjemiske ratelover.</p>
</section>
<section id="differensiallikninger-og-eulers-metode">
<h2>Differensiallikninger og Eulers metode<a class="headerlink" href="#differensiallikninger-og-eulers-metode" title="Permalink to this heading">#</a></h2>
<p>La oss si at vi har et uttrykk for endringen i et system, for eksempler endring i konsentrasjon (fartslover/ratelover) eller endring i posisjon og hastighet (Newtons 2. lov). Disse uttrykkene beskriver den momentane endringen, det vil si den deriverte, som funksjon av tid. De er derfor <em>differensiallikninger</em>.</p>
<p>Eksempler på differensiallikninger er:</p>
<div class="math notranslate nohighlight">
\[f'(x) - x = 2\]</div>
<div class="math notranslate nohighlight">
\[y' = y\]</div>
<div class="math notranslate nohighlight">
\[y' = x - y\]</div>
<div class="math notranslate nohighlight">
\[u' = t + 1\]</div>
<div class="math notranslate nohighlight">
\[u'(t) = u(t)\]</div>
<p>Alle disse er differensiallikner som er skrevet med litt ulike notasjoner. Felles for dem er at de inneholder den deriverte som funksjon av en eller annen variabel. Det kan være nyttig å kalle venstresida av likningen, altså den deriverte, for <span class="math notranslate nohighlight">\(u'(t)\)</span> eller <span class="math notranslate nohighlight">\(y'\)</span>. På høyresida kan det være ulike variabler og konstanter, men det vanligste er at vi har en variabel og den integrerte funksjonen, <span class="math notranslate nohighlight">\(u(t)\)</span> eller <span class="math notranslate nohighlight">\(y\)</span>. Vi kan derfor skrive høyresida som en funksjon av <span class="math notranslate nohighlight">\(t\)</span> og <span class="math notranslate nohighlight">\(y\)</span> eller <span class="math notranslate nohighlight">\(t\)</span> og <span class="math notranslate nohighlight">\(u(t)\)</span>. To vanlige måter å skrive generelle differensiallikninger på, er derfor:</p>
<div class="math notranslate nohighlight">
\[y' = f(t,y)\]</div>
<div class="math notranslate nohighlight">
\[u'(t) = f(t,u(t))\]</div>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Studer differensiallikningene og de generelle uttrykkene og prøv å forstå sammenhengen mellom dem.</p>
</div>
<p>Et praktisk eksempel på en differensiallikning er Newtons 2. lov. Dersom summen av kreftene på ei kule som faller er <span class="math notranslate nohighlight">\(\sum F = G - L\)</span>, får vi:</p>
<p><span class="math notranslate nohighlight">\(\sum F = ma(t)\)</span></p>
<p><span class="math notranslate nohighlight">\(a(t) = \frac{\sum F}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(a(t) = \frac{G}{m} - \frac{L}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(a(t) = \frac{mg}{m} - \frac{kv(t)}{m}\)</span></p>
<p><span class="math notranslate nohighlight">\(v'(t) = g - \frac{kv(t)}{m}\)</span></p>
<p>Her ser vi at den siste likningen inneholder den deriverte av farten (altså akselerasjonen). Altså er dette en differensiallikning.</p>
<div class="admonition-differensiallikninger admonition">
<p class="admonition-title">Differensiallikninger</p>
<p>En differensiallikning er en likning som inneholder den deriverte av en funksjon. I de fleste praktiske situasjoner beskriver slike likninger sammenhengen mellom endringen, <span class="math notranslate nohighlight">\(f'(t)\)</span>, og tilstanden, <span class="math notranslate nohighlight">\(f(t)\)</span>, til et system ved tida <span class="math notranslate nohighlight">\(t\)</span>.</p>
</div>
<p>Det vil altså si at en difflikning er en sammenheng mellom den deriverte til en funksjon, altså endringen i funksjonen, og funksjonen selv. Når vi løser en difflikning, får vi ikke et uttrykk for <span class="math notranslate nohighlight">\(x\)</span>, som når vi løser likninger – vi får et uttrykk for <span class="math notranslate nohighlight">\(f(x)\)</span>. Et enkelt eksempel på dette er:</p>
<p><span class="math notranslate nohighlight">\(f'(x) = 1\)</span></p>
<p>Hva slags funksjon kan være løsningen på en slik likning? Vi veit at å integrere er det motsatte av å derivere. Derfor kan vi jo integrere på begge sider av likningen for å finne <span class="math notranslate nohighlight">\(f(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int f'(x) dx = \int 1\ dx\]</div>
<div class="math notranslate nohighlight">
\[f(x) = x + C\]</div>
<p>Siden den deriverte av <em>x</em> er 1, må integralet av 1 være <em>x</em>. Men den deriverte av for eksempel <span class="math notranslate nohighlight">\(x + 2\)</span> eller <span class="math notranslate nohighlight">\(x + 10\)</span> er jo også <em>1</em>, så derfor må vi legge til en vilkårlig konstant <em>C</em> som viser at det er flere, ja faktisk uendelig, funksjoner som blir 1 når vi deriverer dem. Dette er fordi integralene er <em>ubestemte</em>, det vil si at vi ikke integrerer fra og til en verdi, slik som vi har gjort tidligere.</p>
<p>Med andre ord har vi ofte svært mange eller uendelig mange løsninger av en difflikning. Men i praksis er ofte konstanten bestemt av noen rammebetingelser som vi skal se på, og da får vi ofte én løsning. Denne rammebetingelsen består av en startverdi for <span class="math notranslate nohighlight">\(f(x)\)</span>, det vil si <span class="math notranslate nohighlight">\(f(x_0)\)</span> eller <span class="math notranslate nohighlight">\(y_0\)</span>, som igjen bestemmer hvilken konstant vi får når vi integrerer. Dersom vi har disse initialbetingelsene, kan vi finne neste funksjonsverdi ved å løse en differensiallikning. La oss se på en enkel metode å gjøre dette på.</p>
</section>
<section id="eulers-metode">
<h2>Eulers metode<a class="headerlink" href="#eulers-metode" title="Permalink to this heading">#</a></h2>
<p>Vi har altså en startverdi <span class="math notranslate nohighlight">\(f(x_0)\)</span> og ønsker å finne <span class="math notranslate nohighlight">\(f(x_0 + dx)\)</span>, altså neste funksjonsverdi. I tillegg har vi et uttrykk for den deriverte av funksjonen, nemlig differensiallikningen. Du kjenner faktisk allerede til et uttrykk som inneholder en funksjon og dens deriverte, nemlig definisjonen av den deriverte. La oss bruke den til å utlede en metode for å finne <span class="math notranslate nohighlight">\(f(x + dx)\)</span>. Vi bruker den numeriske definisjonen der vi tilnærmer grenseverdiene med en <em>dx</em> (<span class="math notranslate nohighlight">\(\Delta x\)</span>) som er så liten som mulig:</p>
<div class="math notranslate nohighlight">
\[f'(x) \approx \frac{f(x+dx) - f(x)}{dx}\]</div>
<p>Til å begynne med kjenner vi <span class="math notranslate nohighlight">\(f(x)\)</span>, altså <span class="math notranslate nohighlight">\(f(x_0)\)</span>. Dette er initialbetingelsen, for eksempel startkonsentrasjonen <span class="math notranslate nohighlight">\(c(t_0)\)</span> i eksempelet ovenfor. Vi kjenner også et uttrykk for den deriverte, nemlig differensiallikningen. I tillegg bestemmer vi selv tidssteget <em>dx</em>, men husk at det verken bør være for lite eller for stort. Den eneste ukjente i den numeriske tilnærmingen til den deriverte er altså <span class="math notranslate nohighlight">\(f(x+dx)\)</span>. Det er jo nettopp <span class="math notranslate nohighlight">\(f(x+dx)\)</span> vi prøver å finne, fordi det beskriver tilstanden til systemet ved neste tidssteg. Med litt enkel algebra får vi omformet uttrykket slik at det blir et uttrykk for <span class="math notranslate nohighlight">\(f(x+dx)\)</span>. Vi ganger først med <span class="math notranslate nohighlight">\(dx\)</span> på begge sider:</p>
<div class="math notranslate nohighlight">
\[f'(x)\cdot dx \approx f(x+dx) - f(x)\]</div>
<p>Deretter får vi <span class="math notranslate nohighlight">\(f(x+dx)\)</span> aleine på høyre side og ender opp med følgende likning:</p>
<div class="math notranslate nohighlight">
\[f(x+dx) \approx f(x) + f'(x)\cdot dx\]</div>
<p>Dette er <em>Eulers metode</em>, eller nærmere bestemt <em>Forward Euler</em>. Metoden kalles dette fordi den tar utgangspunkt i framoverdifferansen til den deriverte. Den  brukes til å løse differensiallikninger, det vil si å <em>integrere</em> den deriverte slik at vi finner funksjonsverdiene. Siden vi ofte har å gjøre med funksjoner som varierer med tid, kaller vi gjerne <em>dx</em> for <em>dt</em>.</p>
<div class="admonition-eulers-metode-forward-euler admonition">
<p class="admonition-title">Eulers metode (Forward Euler)</p>
<p>Vi kan finne funksjonsverdiene <span class="math notranslate nohighlight">\(f(t_{k+1})\)</span> ved å bruke funksjonsverdien <span class="math notranslate nohighlight">\(f(t_k)\)</span> og den deriverte av funksjonen ved tida <span class="math notranslate nohighlight">\(t_k\)</span>, <span class="math notranslate nohighlight">\(f'(t_k)\)</span> sammen med en steglengde <span class="math notranslate nohighlight">\(dt\)</span> som representerer en liten <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<div class="math notranslate nohighlight">
\[f(t_{k+1}) = f(t_k) + f'(t_k)\cdot dt\]</div>
</div>
<section id="implementering">
<h3>Implementering<a class="headerlink" href="#implementering" title="Permalink to this heading">#</a></h3>
<p>Vi starter med et enkelt eksempel, nemlig den enkle differensiallikningen vi så på ovenfor, <span class="math notranslate nohighlight">\(f'(x) = 1\)</span>. En vanlig måte å skrive dette på er <span class="math notranslate nohighlight">\(y' = 1\)</span>. Vi lager oss derfor en funksjon som kan inneholde både <span class="math notranslate nohighlight">\(x\)</span> og <span class="math notranslate nohighlight">\(y\)</span>. Vi kan plotte denne for ulike initialbetingelser. En måte å gjøre dette på er slik:</p>
<ol class="arabic simple">
<li><p>Definer hvilke verdier vi skal evaluere funksjonen i, altså et intervall <span class="math notranslate nohighlight">\([x_0, x_{slutt}]\)</span>. Husk at vi bare kan derivere og integrere numerisk i bestemte <em>punkter</em>. Vi får altså ikke funksjoner når vi integrerer en differensiallikning – vi får funksjonsverdier.</p></li>
<li><p>Sett en steglengde som spesifiserer avstanden mellom <em>x</em>-punktene. Ut fra dette regner du ut antall ganger løkka skal gå, altså antall funksjonsverdier vi skal finne. Dette regner vi ut ved å ta differansen mellom <span class="math notranslate nohighlight">\(x_0\)</span> og <span class="math notranslate nohighlight">\(x_{slutt}\)</span>, som vi dividerer på steglengden <span class="math notranslate nohighlight">\(dx\)</span>. Da får vi antall intervaller mellom <span class="math notranslate nohighlight">\(x_0\)</span> og <span class="math notranslate nohighlight">\(x_{slutt}\)</span> med avstand <span class="math notranslate nohighlight">\(dx\)</span>. For å finne antall punkter, må vi derfor ta antall intervaller og legge til 1:</p></li>
</ol>
<p><span class="math notranslate nohighlight">\(N_{punkter} = \frac{x_{slutt} - x_0}{dx} + 1\)</span></p>
<ol class="arabic simple" start="3">
<li><p>Vi definerer så differensiallikningen som en funksjon og lager arrayer <span class="math notranslate nohighlight">\(x\)</span> og <span class="math notranslate nohighlight">\(y\)</span> for å spare på verdiene vi regner ut. Vi fyller inn initalbetingelsene inn i disse arrayene.</p></li>
<li><p>Nå kan vi bruke Eulers metode til å løse differensiallikningen.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Plotteverdier</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>                         <span class="c1"># startverdi for x</span>
<span class="n">x_slutt</span> <span class="o">=</span> <span class="mf">5.0</span>                  <span class="c1"># sluttverdi for x</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">1E-5</span>                      <span class="c1"># steglengde</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">x_slutt</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># antall punkter</span>

<span class="c1"># Initialbetingelser</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>                  <span class="c1"># intitialbetingelse for y</span>

<span class="c1"># Differensiallikningen</span>
<span class="k">def</span><span class="w"> </span><span class="nf">yder</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> 

<span class="c1"># Lager arrayer for å spare på verdiene</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>     <span class="c1"># Legger inn initalbetingelsen for y</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>

<span class="c1"># Eulers metode</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">yder</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">dx</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4c911cb840b67f3e4c070a459fc97dab6f44d520889f68a873bfc00a6fc6be7f.png" src="../../_images/4c911cb840b67f3e4c070a459fc97dab6f44d520889f68a873bfc00a6fc6be7f.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Studer programmet ovenfor og regn ut løkka for hånd med fra <span class="math notranslate nohighlight">\(x = 0\)</span> til <span class="math notranslate nohighlight">\(x = 5\)</span> med steglengde <span class="math notranslate nohighlight">\(dx = 1\)</span>.</p>
</div>
<p>Dersom vi endrer initialbetingelsene, får vi naturlig nok andre løsninger:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotteverdier</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>                         <span class="c1"># startverdi for x</span>
<span class="n">x_slutt</span> <span class="o">=</span> <span class="mf">5.0</span>                  <span class="c1"># sluttverdi for x</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">1E-3</span>                      <span class="c1"># steglengde</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">x_slutt</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># antall punkter</span>

<span class="c1"># Initialbetingelser</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>                  <span class="c1"># intitialbetingelse for y</span>

<span class="c1"># Differensiallikningen</span>
<span class="k">def</span><span class="w"> </span><span class="nf">yder</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> 

<span class="c1"># Lager arrayer for å spare på verdiene</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>

<span class="n">y_liste</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">y_liste</span><span class="p">:</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">yder</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">dx</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;y0=</span><span class="si">{</span><span class="n">y0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f5122c9722337dcdd40e9f3b8e0a6635c872a67a3f1403d11bdc77d8969b95ce.png" src="../../_images/f5122c9722337dcdd40e9f3b8e0a6635c872a67a3f1403d11bdc77d8969b95ce.png" />
</div>
</div>
<p>Det er enkelt å se at funksjonene vi får ovenfor er <span class="math notranslate nohighlight">\(y = x + C\)</span>, der <span class="math notranslate nohighlight">\(C\)</span> avhenger av initialbetingelsene. Vi får derimot ikke selve funksjonsuttrykket som output, men vi får, som nevnt før, <em>funksjonsverdiene</em>. Vi kan også løse likningen <span class="math notranslate nohighlight">\(y' = y + x\)</span> på samme måte. Den analytiske løsningen for denne likningen er <span class="math notranslate nohighlight">\(y = Ce^x - x - 1\)</span>. Resultatene blir da slik for de samme initialbetingelsene som ovenfor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">yder</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span>

<span class="n">y_liste</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">y_liste</span><span class="p">:</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">yder</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">dx</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;y0=</span><span class="si">{</span><span class="n">y0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fa1f5774a5a1badb497922da7b485ff31172d95d88a144988128c1ea08e776ac.png" src="../../_images/fa1f5774a5a1badb497922da7b485ff31172d95d88a144988128c1ea08e776ac.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Løs differensiallikninga <span class="math notranslate nohighlight">\(y' + y^3 = \sin(x)\)</span> med Eulers metode fra <span class="math notranslate nohighlight">\(x = 0\)</span> til <span class="math notranslate nohighlight">\(x = 10\)</span>. Bruk initialbetingelsen <span class="math notranslate nohighlight">\(y(0) = 0\)</span>. Vær nøye med hvordan du definerer funksjonen.</p>
</div>
</section>
</section>
<section id="newtons-2-lov">
<h2>Newtons 2. lov<a class="headerlink" href="#newtons-2-lov" title="Permalink to this heading">#</a></h2>
<p>Vi så at Newtons 2. lov gir oss differensiallikninger når vi omformulerer akselerasjonen som den deriverte av farten.</p>
<div class="math notranslate nohighlight">
\[a(t) = v'(t) = s''(t)\]</div>
<p>Vi kan altså få både en førsteordens og en andreordens difflikning ut av Newtons 2. lov. Det betyr også at vi kan finne akselerasjon og fart ut fra strekning ved å derivere, og motsatt finne fart og posisjon fra akselerasjon ved å integrere. Vi kan med andre ord skrive Newtons 2. lov slik:</p>
<div class="math notranslate nohighlight">
\[F = ma(t) = mv'(t) = ms''(t)\]</div>
<p>La oss ta et eksempel. Når vi slipper ei kule fra en viss høyde, kan vi regne med at to krefter virker på kula: tyngdekraften og luftmotstand. For en lett ball som faller, kan vi si at summen av krefter er summen av gravitasjonskraften og luftmotstanden i <span class="math notranslate nohighlight">\(y\)</span>-retning på en graf. Vi definerer positiv retning oppover <span class="math notranslate nohighlight">\(y\)</span>-aksen.</p>
<div class="math notranslate nohighlight">
\[\sum F = G - L = ma(t) = mv'(t) = ms''(t)\]</div>
<p>Vi ser at vi nå har den deriverte av hastigheten, som er akselerasjonen. For å kunne løse denne likningen, må vi finne ut hva summen av kreftene er. Du husker kanskje at <span class="math notranslate nohighlight">\(G = mg\)</span>, og at en mulig modell for luftmotstand er <span class="math notranslate nohighlight">\(L = -kv\)</span>, der <span class="math notranslate nohighlight">\(k\)</span> er en konstant som blant annet er avhengig av legemets form. Da kan vi skrive uttrykket slik:</p>
<div class="math notranslate nohighlight">
\[ma(t) = - mg + (- kv(t))\]</div>
<div class="math notranslate nohighlight">
\[a(t) = \frac{- mg - kv(t)}{m} = - g - \frac{kv(t)}{m}\]</div>
<p>Dette er en førsteordens difflikning der vi har en funksjon <span class="math notranslate nohighlight">\(v(t)\)</span>, og dens deriverte <span class="math notranslate nohighlight">\(a(t)\)</span> (det vil si <span class="math notranslate nohighlight">\(v'(t)\)</span>). La oss løse denne numerisk.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Konstanter</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.1</span>   <span class="c1"># Luftmotstand</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># Tyngdeakselerasjon i m/s^2</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1"># Masse i kg</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Starthastighet i m/s</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Startposisjon i m</span>

<span class="c1"># Tidsvariabler</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">1E-5</span> <span class="c1"># Tidsintervall i s</span>
<span class="n">tid_start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">tid_slutt</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tid_slutt</span><span class="o">-</span><span class="n">tid_start</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># Antall punkter</span>

<span class="c1"># Arrayer</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># Startverdier</span>
<span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tid_start</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">g</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">m</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fallende kule&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tid (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;strekning (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2e05f5a750b2558a8fb8e9ac2fdfc2b004e5d2e32e7a7200406b566cf098c810.png" src="../../_images/2e05f5a750b2558a8fb8e9ac2fdfc2b004e5d2e32e7a7200406b566cf098c810.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Studer programmet ovenfor og forklar hvordan det fungerer linje for linje.</p>
</div>
<section id="newtons-2-lov-i-kjemi">
<h3>Newtons 2. lov i kjemi<a class="headerlink" href="#newtons-2-lov-i-kjemi" title="Permalink to this heading">#</a></h3>
<p>Du tenker kanskje at Newtons lover kun benyttes i fysikk? Det er ikke tilfellet. Newtons 2. lov benyttes i tilfeller der vi kan beskrive partikler med klassisk mekanikk. Vi bruker loven til å finne akselerasjonen, og dermed hastighet og posisjon, til partikler gitt kreftene mellom dem (svake bindinger). Ovenfor brukte vi et enkelt eksempel med en fallende kule, men eksempelet kan utvides til helt andre tilfeller der kreftene er noe annet enn gravitasjon og luftmotstand. Når vi bruker Newtons 2. lov til å regne ut bevegelsen til atomer og molekyler, bruker vi en simuleringsmetode som kalles <em>molekyldynamikk</em>.</p>
<p>La oss se på et enkelt eksempel der vi bruker en enkel modell for å beskrive vibrasjonen i en binding mellom to like atomer (for eksempel <span class="math notranslate nohighlight">\(O_2\)</span>). Vi kan lage bindingsmodeller som enkle “fjærmodeller”. Da ser vi på atomene som kuler som henger i hver sin ende av en fjær. Dersom bindingen er stiv (høy “fjærkonstant”), vibrerer atomene mye, og motsatt. Enkle fjærkrefter følger Hooks lov:</p>
<div class="math notranslate nohighlight">
\[F = -k\cdot (x - x_0)\]</div>
<p>der <em>x</em> er posisjonen og <span class="math notranslate nohighlight">\(x_0\)</span> er likevektsposisjonen, altså posisjonen der fjæra ikke er komprimert eller strukket ut. Fjærkonstanten <em>k</em> beskriver stivheten til fjæra. Vi kan finne <em>k</em> for ulike bindinger eksperimentelt eller ved hjelp av datasimuleringer.</p>
<p>La oss se på et program som simulerer konseptet bak bindingsvibrasjon. Vi lar en kule stå i ro og beskriver kun hvordan den andre kula beveger seg fram og tilbake. Vi velger enkle verdier for <span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(x0\)</span> og <span class="math notranslate nohighlight">\(t\)</span>, slik at vi får illustrert konseptet enklere. For atomer vil selvsagt disse verdiene være svært mye lavere!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Konstanter og variabler</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>    <span class="c1"># Masse i kg</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>    <span class="c1"># Fjærkonstant</span>
<span class="n">x_eq</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Likevektsposisjon i m</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># Startfart i m/s</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># Startposisjon i m</span>

<span class="c1"># Tidssteg</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">1E-6</span>
<span class="n">tid</span> <span class="o">=</span> <span class="mi">40</span>        <span class="c1"># Tid i s</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tid</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span> <span class="c1"># Intervaller</span>

<span class="c1"># Initialisering</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>

<span class="c1"># Integrasjonsløkke</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x_eq</span><span class="p">)</span>
    <span class="c1"># Eulers metode</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b84e725ed7caa636c1f311bdc0838bb8ae88031923aa65fb2a6025980304cc67.png" src="../../_images/b84e725ed7caa636c1f311bdc0838bb8ae88031923aa65fb2a6025980304cc67.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Studer programmet ovenfor og forklar hvordan det fungerer linje for linje.</p>
</div>
</section>
</section>
<section id="fartslover-ratelover">
<h2>Fartslover (ratelover)<a class="headerlink" href="#fartslover-ratelover" title="Permalink to this heading">#</a></h2>
<p>Fartslover i kjemi er eksempler på differensiallikninger. La oss ta endring i konsentrasjon i reaksjonen mellom hydrogengass og jod i gassfase som et eksempel. Denne reaksjonen har en relativt enkel ratelov. Husk at formen på ratelovene ikke har noen direkte sammenheng med det støkiometriske forholdet mellom reaktanter og produkter. De er derimot basert på empiriske observasjoner (eksperimenter). Reaksjonen er egentlig reversibel, men vi forenkler og beskriver den kun i én retning til å begynne med. Reaksjonslikningen for reaksjonen kan da skrives slik:</p>
<div class="math notranslate nohighlight">
\[H_2 (g) + I_2 (g) \rightarrow 2HI (g)\]</div>
<p>Fartsloven for denne reaksjonen med hensyn på konsentrasjonen av <span class="math notranslate nohighlight">\(HI\)</span> (her kalt <em>c</em>) er som følger:</p>
<div class="math notranslate nohighlight">
\[c'(t) = k_r[H_2][I_2]\]</div>
<p>Vi har altså en likning som beskriver endringen i systemet <span class="math notranslate nohighlight">\(c'(t)\)</span> (en differensiallikning), men ingen informasjon om selve konsentrasjonen <span class="math notranslate nohighlight">\(c(t)\)</span>. Vi ønsker med andre ord å finne konsentrasjonen av <span class="math notranslate nohighlight">\(HI\)</span> ved enhver tid gitt en eller annen startbetingelse (konsentrasjonen av produkter og reaktanter til å begynne med). Det er det samme som å si at vi ønsker å finne funksjonsverdien <span class="math notranslate nohighlight">\(c(t + dt)\)</span> for hvert tidssteg <span class="math notranslate nohighlight">\(dt\)</span>.</p>
<p>Likningen ovenfor har i utgangspunkt tre ukjente, <span class="math notranslate nohighlight">\([HI]_{t+dt}\)</span>, <span class="math notranslate nohighlight">\([H]_{t+dt}\)</span> og <span class="math notranslate nohighlight">\([I]_{t+dt}\)</span>. Heldigvis er disse ukjente størrelsene avhengige av hverandre. Det er fordi alle tar utgangspunkt i den samme rateloven for <span class="math notranslate nohighlight">\([HI]\)</span> fordi de er støkiometrisk ekvivalente (forsvinner 1 mol <span class="math notranslate nohighlight">\(H_2\)</span>, dannes 2 mol <span class="math notranslate nohighlight">\(HI\)</span>, og det brukes 1 mol <span class="math notranslate nohighlight">\(I_2\)</span> osv.). De tre ratelovene kan vi derfor formulere slik:</p>
<div class="math notranslate nohighlight">
\[[HI]'(t) = k_r[H_2][I_2]\]</div>
<div class="math notranslate nohighlight">
\[[H_2]'(t) = -0.5 [HI]'(t) = -0.5 \cdot k_r[H_2][I_2]\]</div>
<div class="math notranslate nohighlight">
\[[I_2]'(t) = [H_2]'(t) = -0.5\cdot k_r[H_2][I_2]\]</div>
<p>For en generell ratelov som løses med Forward Euler, har vi at:</p>
<div class="math notranslate nohighlight">
\[c(t+dt) \approx c(t) + c'(t)\cdot dt\]</div>
<p>Fartslover er koblede differensiallikninger, det vil si at de avhenger av hverandre. Derfor kan det være litt mer å huske på når vi løser farstlover enn når vi for eksempel løser Newtons 2. lov. Her er et eksempel som simulerer utviklingen av <span class="math notranslate nohighlight">\(H_2\)</span>, <span class="math notranslate nohighlight">\(I_2\)</span> og <span class="math notranslate nohighlight">\(HI\)</span> over 500 sekunder:</p>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Forklar hva som skjer i programmet nedenfor og fyll inn det som mangler (Eulers metode).</p>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Løsningsforslag</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">HIder</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">Hder</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">HIder</span>
    <span class="n">Ider</span> <span class="o">=</span> <span class="n">Hder</span>
    <span class="c1"># Eulers metode</span>
    <span class="n">HI</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">HI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">HIder</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Hder</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ider</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span>
</pre></div>
</div>
</div>
<iframe src="https://trinket.io/embed/python3/09d06157a6" width="100%" height="600" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe><p>Ofte kan det være lurt å gruppere kode i funksjoner slik at det er lettere å gjenbruke koden og fordi vi da har større kontroll på når vi gjør hver operasjon.</p>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Modifiser programmet ovenfor slik at du bruker en funksjon <em>forward_euler(HI0, H20, I20, k, tid_slutt, h)</em> til å integrere fartslovene.</p>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Løsningsforslag</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span> 

<span class="c1"># Difflikninger</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dHI</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">k</span><span class="o">*</span><span class="n">H</span><span class="o">*</span><span class="n">I</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dH2</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">H</span><span class="o">*</span><span class="n">I</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dI2</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">H</span><span class="o">*</span><span class="n">I</span>

<span class="c1">#Forward Euler</span>
<span class="k">def</span><span class="w"> </span><span class="nf">FE</span><span class="p">(</span><span class="n">HI0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">tid_slutt</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">1E-5</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tid_slutt</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>
    <span class="n">HI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">HI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">HI0</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">H0</span>
    <span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">I0</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">HIder</span> <span class="o">=</span> <span class="n">dHI</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">k</span><span class="p">)</span>
        <span class="n">Hder</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">HIder</span>
        <span class="n">Ider</span> <span class="o">=</span> <span class="n">Hder</span>
        <span class="n">HI</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">HI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">HIder</span><span class="o">*</span><span class="n">h</span>
        <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Hder</span><span class="o">*</span><span class="n">h</span>
        <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ider</span><span class="o">*</span><span class="n">h</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span>
    <span class="k">return</span> <span class="n">HI</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">t</span>

<span class="n">HI</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">FE</span><span class="p">(</span><span class="n">HI0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">H0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">I0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mf">4.84E-2</span><span class="p">,</span> <span class="n">tid_slutt</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reaksjonskinetikk for dannelse av HI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tid (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Konsentrasjon (mol/L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">HI</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;HI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;H2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Ved høye temperaturer vil flere og flere HI-molekyler kollidere og rives løs igjen til <span class="math notranslate nohighlight">\(I_2\)</span> og <span class="math notranslate nohighlight">\(H_2\)</span>. Reaksjonen er derfor egentlig reversibel, selv om vi har gjort en forenkling og beskrevet den som irreversibel ovenfor. Det viser seg at den motsatte reaksjonen følger denne rateloven:</p>
<div class="math notranslate nohighlight">
\[c'(t) = k_{bakover}[HI]^2\]</div>
<p>Reaksjonen er altså andreordens med hensyn på konsentrasjonen av hydrogenjodid. Den totale rateloven for hydrogenjodid blir derfor:</p>
<div class="math notranslate nohighlight">
\[c'(t) = k_{framover}[H_2][I_2] - k_{bakover}[HI]^2\]</div>
<p>Dersom vi kjenner likevektskonstanten <span class="math notranslate nohighlight">\(K\)</span> ved den gitte temperaturen, kan vi finne <span class="math notranslate nohighlight">\(k_{bakover}\)</span> ved å benytte følgende sammenheng:</p>
<div class="math notranslate nohighlight">
\[K = \frac{k_{framover}}{k_{bakover}}\]</div>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Lag et program som simulerer reaksjonen mellom <span class="math notranslate nohighlight">\(I_2\)</span> og <span class="math notranslate nohighlight">\(H_2\)</span> ved 450<span class="math notranslate nohighlight">\(^\circ\)</span>C. Sett likevektskontstanten til å være 10 og <span class="math notranslate nohighlight">\(k_{framover}\)</span> til å være <span class="math notranslate nohighlight">\(4.8\cdot 10^{-2}\)</span>. Lag et plott som viser konsentrasjonen som funksjon av tid, og et plott som viser reaksjonsfarten som funksjon av tid. Kommenter plottene. Stemmer dette med det du kan om likevekter?</p>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Løsningsforslag</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1">#Initialbetingelser</span>

<span class="n">H0</span> <span class="o">=</span> <span class="mi">1</span>          <span class="c1"># Konsentrasjon av hydrogengass i mol/L    </span>
<span class="n">I0</span> <span class="o">=</span> <span class="mi">1</span>          <span class="c1"># Konsentrasjon av jodgass i mol/L</span>
<span class="n">HI0</span> <span class="o">=</span> <span class="mi">0</span>         <span class="c1"># Konsentrasjon av hydrogenjodid i mol/L</span>
<span class="n">k_f</span> <span class="o">=</span> <span class="mf">4.84E-2</span>   <span class="c1"># Ratekonstanten forover</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">10</span>          <span class="c1"># Omtrentlig likevektskonstant ved 400 grader</span>
<span class="n">k_b</span> <span class="o">=</span> <span class="n">k_f</span><span class="o">/</span><span class="n">K</span>     <span class="c1"># K = k_framover/k_bakover</span>

<span class="c1">#Tidssteg</span>
<span class="n">tid_slutt</span> <span class="o">=</span> <span class="mi">250</span>            <span class="c1"># antall sekunder</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c1"># starttid</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">1E-3</span>                  <span class="c1"># tidsintervallet</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tid_slutt</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span> <span class="c1"># antall punkter</span>

<span class="n">HI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1">#Arrayer</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>        <span class="c1"># Tid i sekunder</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>        <span class="c1"># Konsentrasjon av H2</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>        <span class="c1"># Konsentrasjon av I2</span>
<span class="n">HI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>       <span class="c1"># Konsentrasjon av HI</span>
<span class="n">Hder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>     <span class="c1"># Konsentrasjonsendring av H2</span>
<span class="n">Ider</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>     <span class="c1"># Konsentrasjonsendring av I2</span>
<span class="n">HIder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>    <span class="c1"># Konsentrasjonsendring av HI</span>
<span class="n">forlengsrate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">baklengsrate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">H0</span>
<span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">I0</span>
<span class="n">HI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">HI0</span>

<span class="c1"># Eulers metode</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">forlengsrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_f</span><span class="o">*</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">baklengsrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_b</span><span class="o">*</span><span class="n">HI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">HIder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">forlengsrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">baklengsrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>    <span class="c1"># Rateloven for HI</span>
    <span class="n">Hder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">HIder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>        <span class="c1"># Endringen i [H2]</span>
    <span class="n">Ider</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>               <span class="c1"># Endringen i [I2]</span>
    <span class="n">HI</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">HI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">HIder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Hder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ider</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reaksjonsfart for dannelse av HI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tid (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reaksjonsfart (mol/L)/s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">forlengsrate</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;H$_2$ + I$_2$ --&gt; 2HI&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">baklengsrate</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;2HI --&gt; H$_2$ + I$_2$&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;maroon&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;tid (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Konsentrasjon (mol/L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">HI</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Produkter&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Reaktanter&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Når vi løser differensiallikninger, er det ikke alltid tilnærmingene er gode. Spesielt når vi har å gjøre med svingninger, gir Forward Euler ustabile og ofte helt feil resultater, spesielt med mindre <span class="math notranslate nohighlight">\(dt\)</span> er svært liten. Og dersom <span class="math notranslate nohighlight">\(dt\)</span> blir svært liten, får vi også et problem med veldig tunge beregninger. Det kan også bli et problem dersom vi ønsker å studere et system langt fram i tid. Forward Euler er derfor mer ment som en introduksjon til løsing av differensiallikninger, da metoden i seg selv ikke benyttes i stor grad. Vi skal nå se på et utvalg andre metoder.</p>
</section>
<section id="backward-euler">
<h2>Backward Euler<a class="headerlink" href="#backward-euler" title="Permalink to this heading">#</a></h2>
<p>Forskjellen på Forward Euler (FE) og Backward Euler (BE) er liten i teorien, men betydelig for implementering. FE regner ut funksjonsverdien ved tida <span class="math notranslate nohighlight">\(t+dt\)</span> med utgangspunkt funksjonsverdien ved tida <span class="math notranslate nohighlight">\(t\)</span> og den deriverte av funksjonen ved tida <span class="math notranslate nohighlight">\(t\)</span>. BE regner ut funksjonsverdien ved tida <span class="math notranslate nohighlight">\(t+dt\)</span> med funksjonsverdien ved tida <span class="math notranslate nohighlight">\(t\)</span> og den deriverte av funksjonen ved tida <span class="math notranslate nohighlight">\(t+dt\)</span>. Det er altså bare en forskjell i hvilken deriverte vi tar utgangspunkt i: FE tar utgangspunkt i framoverdifferansen av den deriverte, mens BE tar utgangspunkt i bakoverdifferansen. Dette ser ubetydelig ut, men det gir en ganske stor forskjell i hvordan vi implementerer metoden.</p>
<p>Vi kaller Forward Euler for en <em>eksplisitt metode</em> fordi vi finner tilstanden til et system ved et seinere tidspunkt (<span class="math notranslate nohighlight">\(t + dt\)</span>) ut fra endringen av systemet ved det nåværende tidspunktet (<span class="math notranslate nohighlight">\(f'(t)\)</span>). Backward Euler er derimot en <em>implisitt metode</em> fordi vi finner tilstanden til et system ved et seinere tidspunkt (<span class="math notranslate nohighlight">\(t + dt\)</span>) ut fra endringen av systemet ved det samme tidspunktet (<span class="math notranslate nohighlight">\(f'(t + dt)\)</span>). Vi kan generalisere BE-metoden slik:</p>
<p>Implisitte metoder er gode på såkalte <em>stive</em> differensiallikninger, det vil si likninger som er numerisk ustabile med mindre tidssteget er svært lite. Numerisk ustabile likninger gir løsninger med en betydelig feil som ofte akkumuleres over tid. BE gir også gode resultater med store tidssteg og egner seg derfor godt til simulering av systemer over lengre tidsintervaller, men den gir i utgangspunktet like store feil som FE med samme tidssteg. Den egner seg derfor best som introduksjon til implisitte metoder, og vi skal derfor ikke se på implementering av denne metoden her. Vi skal snart se på hvordan vi kan bruke implisitte metoder fra scipy-biblioteket til å løse stive differensiallikninger. Men før vi gjør det, skal vi kikke litt på en metode som er mye brukt til å løse differensiallikninger som ikke er stive, nemlig Runge-Kutta 4.</p>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Oppsummer hva som er forskjellene og likhetene mellom Forward Euler og Backward Euler, og hva som er forskjellen på en eksplisitt og en implisitt metode.</p>
</div>
</section>
<section id="runge-kutta-4">
<h2>Runge-Kutta 4<a class="headerlink" href="#runge-kutta-4" title="Permalink to this heading">#</a></h2>
<p>Forward Euler er en del av en større familie av numeriske metoder kalt <em>Runge-Kutta-metoder</em>. Disse metodene blei systematisert og utvikla av de tyske matematikerne Carl Runge og Martin Wilhelm Kutta på starten av 1900-tallet. En av de vanligste Runge-Kutta-metodene kalles <em>Runge-Kutta 4</em> (RK4), og er en <em>fjerdeordens</em> RK-metode. Med det menes det at en funksjon evalueres på fire ulike steder per funksjonsverdiestimat. Dette krever en del regnekraft, men RK4 er en svært mye brukt metode på grunn av algoritmens stabilitet og presisjon. Det er en eksplisitt metode på lik linje med FE, så for store tidssteg er den ikke så god på stive differensiallikninger. Eulers metode er den enkleste RK-metoden, og er av første orden (RK1). Vi kan generalisere RK4 slik:</p>
<div class="admonition-runge-kutta-4 admonition">
<p class="admonition-title">Runge-Kutta 4</p>
<p>En differensiallikning <span class="math notranslate nohighlight">\(y' = f(t, y)\)</span> kan løses gitt en initialbetingelse <span class="math notranslate nohighlight">\(y(t_0)\)</span> og en steglengde <span class="math notranslate nohighlight">\(dt\)</span> ved følgende metode:</p>
<p>for n = 0, 1, 2, 3, …, N:</p>
<p><span class="math notranslate nohighlight">\(k_1 = f(t_n, y_n) \cdot dt\)</span></p>
<p><span class="math notranslate nohighlight">\(k_2 = f(t_n + \frac{dt}{2}, y_n + \frac{k_1}{2})\cdot dt\)</span></p>
<p><span class="math notranslate nohighlight">\(k_3 = f(t_n + \frac{dt}{2}, y_n + \frac{k_2}{2})\cdot dt\)</span></p>
<p><span class="math notranslate nohighlight">\(k_4 = f(t_n + dt, y_n + k_3)\cdot dt\)</span></p>
<p><span class="math notranslate nohighlight">\(y_{n+1} = y_n + \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\)</span></p>
<p><span class="math notranslate nohighlight">\(t_{n+1} = t_n + dt\)</span></p>
</div>
</section>
<section id="ode-losere">
<h2>ODE-løsere<a class="headerlink" href="#ode-losere" title="Permalink to this heading">#</a></h2>
<p>Backward-metoder og Runge-Kutta-metoder av høyere orden er vanskelig å implementere. La oss se derfor se hvordan vi kan løse differensiallikninger med funksjoner fra scipy-biblioteket. De differensiallikningene vi har sett på, kaller vi for <em>ODE-er</em> (ordinary differential equations) for å skille dem fra <em>PDE-er</em> (partial differential equations). Vi skal ikke se på partielle differensiallikninger her, men mange av prinsippene for å løse dem er like som for ODE-er. Vi kommer til å bruke ODE som forkortelse videre.</p>
<p>Vi starter med enkle differensiallikninger for å illustrere de grunnleggende prinsippene. En enkel differensiallikning vi kan begynne med, er:</p>
<div class="math notranslate nohighlight">
\[y' = t - y\]</div>
<p>Vi kan skrive høyresida her som <span class="math notranslate nohighlight">\(f(t,y)\)</span>, siden den kan beskrives som en funksjon av <em>t</em> og <em>y</em>. Deretter kan vi implementere en løser ved hjelp av en funksjon som heter <em>solve_ivp</em> (“solve initial value problem”).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dy_dt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">-</span> <span class="n">y</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y_int</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dy_dt</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_int</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">y_int</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3117535104d683b7a607ce112e5ba9fe9a870830b64b39d5002384960ce99401.png" src="../../_images/3117535104d683b7a607ce112e5ba9fe9a870830b64b39d5002384960ce99401.png" />
</div>
</div>
<p>Vi definerer her et sett med t-verdier slik at vi får et intervall å integrere over. Dernest er det viktig å ha en startbetingelse for <span class="math notranslate nohighlight">\(y\)</span> (husk: vi trenger den forrige <span class="math notranslate nohighlight">\(y\)</span>-verdien for å finne den neste). Funksjonen <em>solve_ivp</em> er en generell løser for differensiallikninger og tar som første parameter en funksjon av typen <span class="math notranslate nohighlight">\(f(t,y)\)</span> – legg merke til rekkefølgen på parameterne. Deretter legger vi inn tidsintervallet som vi skal integrere over. Dette legges inn som en liste.</p>
<p>Etter tidsintervallet legges startbetingelsene inn. Siden <em>solve_ivp</em> er en løser som kan løse systemer av differensiallikninger, må vi lage startbetingelsen som en liste. Deretter har vi en del valgfrie parametre. Vi har brukt parameteren <em>t_eval</em> her fordi den sier hvilke <span class="math notranslate nohighlight">\(t\)</span>-verdier vi skal regne ut <span class="math notranslate nohighlight">\(y\)</span>-verdier for. Hvis vi ikke gjør dette, får vi integralet kun evaluert i noen få punkter. Det kan være greit hvis vi for eksempel bare ønsker sluttverdien, men ikke hvis vi ønsker å plotte resultatene.</p>
<p>Dersom du prøver å printe ut resultatene fra <em>solve_ivp</em>, får du mye ulik informasjon. Derfor henter vi ut spesifikke <em>t-</em> og _y-_verdier ved  å skrive <em>y_int2.t</em>, som henter ut tidsverdiene, og <em>y_int2.y[0]</em>, som henter ut <em>y</em>-verdiene. Legg merke til at <span class="math notranslate nohighlight">\(y\)</span> kan inneholde flere elementer ettersom vi kan løse systemer av differensiallikninger. Her må vi eksplisitt be om det første elementet (element 0 med Python-språk), selv om arrayen ikke inneholder flere <span class="math notranslate nohighlight">\(y\)</span>-verdier.</p>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Løs differensiallikningen <span class="math notranslate nohighlight">\(f'(t) = \cos(t)\)</span> med <span class="math notranslate nohighlight">\(f(t_0) = 0\)</span> med <em>solve_ivp</em> fra <span class="math notranslate nohighlight">\(t=0\)</span> til <span class="math notranslate nohighlight">\(t=\pi\)</span>. Plott den analytiske løsningen <span class="math notranslate nohighlight">\(f(t) = \sin(t)\)</span> i samme koordinatsystem for å sammenlikne.</p>
</div>
<p>Algoritmene som brukes i slike biblioteker, er ofte sammensatte algoritmer som benytter seg av flere prinsipper enn en enkelt metode. Som standard benytter <em>solve_ivp</em> seg av en blanding av Runge-Kutta 4 og Runge-Kutta 5, kalt RK45. Vi kan gi en ekstra parameter <em>method</em> for å angi andre metoder. For eksempel kan det være nyttig med en <em>backward-løser</em> hvis vi skal løse stive differensiallikninger. En slik metode er BDF (Backward Differentiation Formula):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_int</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dy_dt</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;BDF&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Dette er altså en samling av bakoverløsere i samme familie. Den benytter automatisk en orden som passer likningene vi skal løse. Dersom ordenen settes lik 1, får vi Backward Euler, som vi har sett på tidligere.</p>
<p>Vi har nå en måte å løse de koblede ratelovene på med Scipy-biblioteket. Det som er lurt å gjøre først, er å omformulere ratelovene som én Python-funksjon som returnerer ratelovene som en array eller liste med tre elementer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ratelover</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">CHI</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">CH2</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">CI2</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mf">4.84E-2</span>
    <span class="n">dHIdt</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">CH2</span><span class="o">*</span><span class="n">CI2</span>
    <span class="n">dH2dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dHIdt</span>
    <span class="n">dI2dt</span> <span class="o">=</span> <span class="n">dH2dt</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dHIdt</span><span class="p">,</span> <span class="n">dH2dt</span><span class="p">,</span> <span class="n">dI2dt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Her er det viktig å huske på at <span class="math notranslate nohighlight">\(y\)</span> må være en array med tre elementer: ett element for hver startbetingelse. Deretter formulerer vi ratelovene ut fra disse startbetingelsene. Ettersom funksjonen integreres, får vi nye verdier for <span class="math notranslate nohighlight">\(y[0]\)</span>, <span class="math notranslate nohighlight">\(y[1]\)</span> og <span class="math notranslate nohighlight">\(y[2]\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Underveisoppgave</p>
<p>Studer funksjonen ovenfor og forklar hver linje med kode, og hva som skjer med disse verdiene når funksjonen integreres.</p>
</div>
<p>Videre kan vi løse og plotte ODE-ene på samme måte som tidligere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Array med startverdier</span>
<span class="n">y_int</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">ratelover</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;c (mol/L)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_int</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">y_int</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Plotter [HI]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_int</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">y_int</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Plotter [H2]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/02eb3b930f312f84b2342d1d30ab164423b502ba74018f324de39662ee4d78e9.png" src="../../_images/02eb3b930f312f84b2342d1d30ab164423b502ba74018f324de39662ee4d78e9.png" />
</div>
</div>
</section>
<section id="oppgaver">
<h2>Oppgaver<a class="headerlink" href="#oppgaver" title="Permalink to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Oppgave</p>
<p>Implementer Eulers metode som en Python-funksjon, og løs differensiallikningen <span class="math notranslate nohighlight">\(y' = y\)</span> med initialbetingelsen <span class="math notranslate nohighlight">\(y(0) = 2\)</span>. Løs den samme likningen med ulike løsninger fra scipy-biblioteket og sammenlikn resultatene.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Oppgave</p>
<p>Ta en generell irreversibel reaksjon <span class="math notranslate nohighlight">\(A + B \rightarrow 2C\)</span> som følger rateloven <span class="math notranslate nohighlight">\(\frac{dC}{dt} = k[A][B]\)</span>. Vi starter med 1.00 mol/L av hver av reaktantene, og 0 mol/L av produktet. Ratekonstanten k = 0.01 s<span class="math notranslate nohighlight">\(^{-1}\)</span>.
Lag et program som simulerer utviklingen de 500 første sekundene.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Oppgave</p>
<p>Løs puslespillet nedenfor.</p>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="1000"
            height="550"
            src="https://parsons.herokuapp.com/puzzle/67c135760a964287b3dfa83e658cfd00"
            frameborder="0"
            allowfullscreen
        ></iframe>
        </div></div>
</div>
</section>
<section id="videoer">
<h2>Videoer<a class="headerlink" href="#videoer" title="Permalink to this heading">#</a></h2>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
Differensiallikninger</label><div class="sd-tab-content docutils">
<iframe width="850" height="450" src="https://www.youtube.com/embed/O08ToTAqp5w" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
Fartslover (ratelover)</label><div class="sd-tab-content docutils">
<iframe width="850" height="450" src="https://www.youtube.com/embed/Ql-68OsKDaQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/modellering"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="diskret_modellering.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Differenslikninger</p>
      </div>
    </a>
    <a class="right-next"
       href="../forelesninger/forelesninger.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Forelesninger</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivasjon">Motivasjon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#differensiallikninger-og-eulers-metode">Differensiallikninger og Eulers metode</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eulers-metode">Eulers metode</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementering">Implementering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newtons-2-lov">Newtons 2. lov</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#newtons-2-lov-i-kjemi">Newtons 2. lov i kjemi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fartslover-ratelover">Fartslover (ratelover)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backward-euler">Backward Euler</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runge-kutta-4">Runge-Kutta 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ode-losere">ODE-løsere</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#oppgaver">Oppgaver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videoer">Videoer</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andreas Haraldsrud
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>